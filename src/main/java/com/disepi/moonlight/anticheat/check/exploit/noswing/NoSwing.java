package com.disepi.moonlight.anticheat.check.exploit.noswing;

import cn.nukkit.Player;
import cn.nukkit.event.entity.EntityDamageByEntityEvent;
import cn.nukkit.network.protocol.PlayerActionPacket;
import com.disepi.moonlight.anticheat.check.Check;
import com.disepi.moonlight.anticheat.player.PlayerData;

public class NoSwing extends Check {
    // Constructor
    public NoSwing() {
        super("NoSwing", "Player did not swing as expected", 4);
    }

    public void check(EntityDamageByEntityEvent e, PlayerData d, Player p) {
        reward(d, 0.25f); // Violation reward
        if (!d.isPlayerSwinging(5)) {
            fail(p, "expected swing did not occur, vl=" + (int) getViolationScale(d)); // fail
            violate(p, d, 1, true); // Violate
        }
    }

    public void check(PlayerActionPacket e, PlayerData d, Player p) {
        reward(d, 0.25f); // Violation reward
        if (e.action == PlayerActionPacket.ACTION_START_BREAK && !d.isPlayerSwinging(5)) {
            fail(p, "expected swing did not occur, vl=" + (int) getViolationScale(d)); // fail
            violate(p, d, 1, true); // Violate
        }
    }
}
